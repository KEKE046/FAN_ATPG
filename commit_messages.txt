Refactor - 28th modification

  readability related changes:
    declare i,j... in for loop as there is no performance improve for declaration outside the for loop 
  performance related changes:
  bug fixed:
  note:
  function added:
  function removed: